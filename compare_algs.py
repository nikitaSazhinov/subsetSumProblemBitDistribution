from algorithms import karmarkarKarp
from algorithms import greedyPartition
from generate import generateTemplatesInstance
from tree import runBBWithSolutions
import pandas as pd


#MS First
# data = []
# for index in range(0,7):
#     bb_res = []
#     greedy_res = []
#     kk_res = []
#     for i in range(0,100):
#         instances = generateTemplatesInstance(multiset=True)
#         i = instances[index]
#         bb_res.append(runBBWithSolutions(i)["val"])
#         greedy_res.append(greedyPartition(i))
#         kk_res.append(karmarkarKarp(i))
#     data.append([bb_res, greedy_res, kk_res])


# counter = 0 
# ax = ["S-3", "S-2", "S-1", "S-0", "S-N1", "S-N2", "S-N3"]
# for val in data:
#     filename_raw = "datasheets/compare/compare_algs_" + ax[counter] + ".xlsx"
#     excelData = pd.DataFrame({"BB":val[0], "GR": val[1], "KK": val[2]})
#     excelData.to_excel(filename_raw, sheet_name='data', index=False)
#     counter += 1

# # Sets
# data = []
# for index in range(0,7):
#     bb_res = []
#     greedy_res = []
#     kk_res = []
#     for i in range(0,100):
#         instances = generateTemplatesInstance(multiset=False)
#         i = instances[index]
#         bb_res.append(runBBWithSolutions(i)["val"])
#         greedy_res.append(greedyPartition(i))
#         kk_res.append(karmarkarKarp(i))
#     data.append([bb_res, greedy_res, kk_res])



# counter = 0 
# ax = ["S-3", "S-2", "S-1", "S-0", "S-N1", "S-N2", "S-N3"]
# for val in data:
#     filename_raw = "datasheets/compare/compare_set_algs_" + ax[counter] + ".xlsx"
#     excelData = pd.DataFrame({"BB":val[0], "GR": val[1], "KK": val[2]})
#     excelData.to_excel(filename_raw, sheet_name='data', index=False)
#     counter += 1


# Code used to generate figure 5.

instancesString ="""[10316, 5249, 3284, 1765, 782, 456, 198, 122, 43, 31, 15, 5, 2, 1]
[14991, 4358, 3742, 1446, 753, 492, 166, 72, 38, 26, 9, 4, 2, 1]
[9576, 6333, 3685, 1988, 935, 489, 180, 119, 56, 31, 11, 5, 1, 0]
[10974, 5084, 3859, 1483, 598, 474, 151, 103, 58, 31, 15, 7, 2, 1]
[15334, 4211, 2064, 1683, 1013, 320, 223, 110, 38, 15, 14, 5, 3, 1]
[8510, 7579, 3583, 1910, 795, 265, 245, 109, 35, 31, 14, 3, 2, 0]
[13172, 4374, 3295, 1067, 837, 387, 234, 124, 46, 29, 15, 6, 2, 0]
[15431, 7760, 2080, 1128, 594, 324, 201, 71, 56, 23, 12, 6, 2, 1]
[10150, 4095, 3356, 1049, 703, 470, 216, 68, 36, 21, 10, 5, 2, 1]
[11571, 6285, 3864, 1153, 930, 332, 152, 106, 43, 26, 9, 3, 2, 0]
[10130, 5259, 2166, 1176, 810, 506, 186, 122, 56, 29, 15, 4, 2, 1]
[14730, 7096, 3310, 1559, 588, 272, 221, 72, 51, 25, 15, 4, 3, 0]
[8257, 7722, 3388, 1824, 799, 357, 166, 117, 49, 25, 9, 7, 1, 0]
[14055, 7017, 2870, 1728, 670, 357, 208, 113, 53, 27, 12, 4, 2, 1]
[14474, 5086, 2927, 1103, 777, 375, 237, 105, 32, 26, 9, 3, 2, 1]
[8783, 6962, 3581, 1873, 692, 511, 205, 64, 46, 16, 14, 4, 2, 1]
[10346, 5124, 2969, 1188, 678, 479, 182, 72, 59, 23, 8, 7, 2, 0]
[10386, 4125, 2785, 1723, 722, 423, 187, 81, 32, 24, 12, 3, 2, 1]
[8320, 4384, 2867, 1887, 867, 411, 150, 102, 54, 28, 8, 6, 1, 0]
[13424, 6396, 3889, 1642, 866, 450, 201, 80, 47, 27, 11, 6, 1, 0]
[8471, 4679, 3016, 1772, 541, 402, 155, 86, 45, 31, 10, 5, 1, 0]
[12392, 6425, 3724, 1650, 744, 412, 227, 91, 35, 24, 12, 5, 1, 0]
[15867, 7478, 3158, 1674, 664, 277, 134, 85, 49, 25, 9, 5, 1, 0]
[10616, 6517, 3625, 1622, 824, 334, 237, 70, 39, 23, 14, 5, 1, 0]
[12152, 6946, 2505, 1990, 570, 455, 245, 91, 33, 24, 8, 6, 3, 1]
[8738, 7180, 2141, 1353, 562, 439, 185, 68, 34, 28, 9, 7, 2, 1]
[14975, 4547, 3589, 1881, 799, 449, 132, 83, 38, 26, 10, 5, 1, 0]
[15244, 7623, 2912, 1946, 866, 406, 210, 80, 35, 26, 13, 7, 3, 0]
[14357, 5472, 2313, 1446, 902, 370, 156, 104, 62, 19, 9, 5, 3, 1]
[10413, 7532, 2676, 1905, 913, 443, 188, 80, 52, 27, 7, 5, 2, 1]
[15053, 5484, 2399, 2029, 851, 436, 178, 114, 35, 31, 10, 3, 1, 0]
[14725, 5284, 2369, 1887, 788, 311, 247, 112, 39, 17, 15, 4, 1, 0]
[16093, 5135, 2245, 1478, 839, 363, 166, 90, 53, 23, 14, 6, 2, 1]
[13098, 6040, 2855, 1522, 680, 409, 219, 110, 58, 26, 13, 4, 2, 1]
[14071, 5611, 2189, 1653, 530, 264, 196, 87, 51, 20, 8, 5, 2, 0]
[14075, 6550, 3727, 1129, 840, 508, 220, 91, 63, 24, 9, 5, 3, 0]
[11079, 5758, 2349, 1125, 1018, 499, 127, 74, 59, 21, 8, 4, 1, 0]
[11269, 4531, 4095, 1494, 614, 372, 177, 92, 33, 31, 12, 6, 3, 1]
[12084, 5179, 3952, 1632, 822, 498, 190, 127, 55, 15, 9, 5, 1, 0]
[11781, 6805, 3340, 1177, 980, 480, 244, 108, 44, 19, 7, 4, 3, 1]
[14132, 7010, 3432, 1181, 723, 367, 253, 77, 63, 26, 15, 4, 1, 0]
[11885, 7802, 2307, 1505, 820, 417, 160, 82, 46, 19, 14, 4, 2, 0]
[11965, 7356, 2390, 1939, 767, 356, 173, 113, 42, 29, 11, 6, 2, 1]
[10611, 4646, 2594, 1334, 547, 397, 212, 67, 51, 18, 10, 5, 3, 1]
[8324, 8092, 2693, 1681, 614, 380, 218, 95, 57, 26, 10, 5, 1, 0]
[9073, 6862, 2938, 1109, 710, 476, 244, 71, 32, 21, 8, 7, 3, 0]
[10497, 4304, 2152, 1994, 913, 310, 207, 102, 49, 26, 13, 6, 2, 0]
[12073, 7933, 2217, 1481, 822, 443, 176, 69, 49, 25, 8, 4, 3, 0]
[9875, 5304, 2115, 1568, 557, 308, 163, 104, 53, 27, 12, 7, 3, 0]
[15743, 7484, 3077, 1732, 807, 507, 228, 95, 45, 23, 7, 5, 2, 1]
[11866, 6005, 2441, 1083, 982, 348, 234, 111, 61, 19, 14, 5, 1, 0]
[14984, 5876, 2794, 1077, 935, 367, 174, 121, 59, 25, 14, 6, 1, 0]
[14859, 4404, 2188, 1323, 790, 304, 245, 125, 63, 29, 14, 4, 1, 0]
[10229, 4831, 2549, 1250, 678, 306, 170, 89, 31, 19, 8, 5, 1, 0]
[16314, 5664, 3752, 1854, 816, 479, 186, 116, 46, 19, 8, 5, 1, 0]
[8443, 6141, 3121, 1230, 979, 369, 229, 64, 59, 24, 10, 5, 1, 0]
[9254, 4785, 2959, 1904, 926, 258, 164, 89, 45, 22, 9, 5, 3, 0]
[15428, 6977, 3531, 1527, 891, 257, 132, 93, 54, 16, 8, 4, 2, 1]
[8828, 5335, 2557, 1973, 991, 397, 188, 65, 38, 22, 8, 7, 3, 1]
[13175, 4976, 2210, 1672, 583, 379, 127, 109, 34, 29, 14, 4, 3, 0]
[11747, 7001, 2415, 1799, 732, 365, 181, 88, 32, 25, 7, 4, 2, 0]
[9607, 7828, 3677, 1611, 1000, 477, 169, 100, 57, 25, 13, 7, 3, 0]
[13497, 5275, 3154, 1147, 780, 264, 240, 106, 57, 18, 15, 7, 3, 0]
[15988, 5163, 2113, 1239, 689, 301, 191, 79, 47, 21, 8, 5, 2, 1]
[15405, 4619, 3438, 1340, 840, 494, 200, 91, 34, 22, 12, 3, 2, 0]
[13803, 7530, 2875, 1630, 695, 355, 133, 77, 55, 17, 7, 6, 2, 0]
[13458, 7222, 2840, 2019, 1022, 272, 248, 119, 48, 16, 15, 6, 3, 0]
[13873, 5346, 2729, 1793, 977, 363, 162, 123, 32, 17, 9, 3, 2, 0]
[16048, 4381, 2807, 1634, 562, 496, 140, 114, 36, 29, 7, 3, 2, 1]
[10755, 6988, 4079, 1338, 981, 483, 198, 110, 60, 22, 9, 3, 2, 1]
[12630, 7346, 3094, 1487, 728, 430, 223, 126, 57, 16, 7, 6, 1, 0]
[13826, 7339, 3029, 1200, 517, 286, 250, 119, 52, 25, 11, 6, 2, 0]
[14455, 4957, 3791, 1987, 558, 482, 191, 105, 47, 31, 12, 4, 2, 1]
[15544, 6845, 3636, 1501, 739, 482, 195, 76, 46, 22, 15, 4, 3, 1]
[9362, 4472, 3310, 1405, 827, 301, 185, 105, 45, 21, 14, 5, 2, 0]
[12359, 4917, 3469, 1884, 628, 315, 235, 122, 63, 21, 10, 5, 2, 1]
[9406, 7040, 2900, 1249, 655, 473, 201, 99, 34, 27, 12, 6, 2, 1]
[10224, 4739, 3031, 1871, 866, 297, 219, 99, 45, 23, 14, 5, 2, 0]
[15141, 7359, 2378, 1595, 981, 344, 243, 70, 59, 25, 8, 4, 1, 0]
[14341, 7845, 2508, 1079, 889, 286, 161, 85, 63, 29, 9, 3, 1, 0]
[13935, 4507, 3256, 1954, 970, 463, 128, 107, 63, 15, 14, 7, 3, 1]
[12518, 4491, 3937, 1802, 851, 391, 153, 110, 63, 21, 9, 3, 2, 1]
[13258, 6728, 4076, 1081, 974, 270, 144, 126, 45, 24, 7, 6, 1, 0]
[9853, 5204, 3406, 1635, 770, 405, 189, 81, 48, 15, 8, 5, 2, 0]
[15376, 7943, 2193, 1066, 1020, 255, 134, 80, 50, 30, 9, 5, 1, 0]
[12271, 7173, 3281, 1587, 840, 399, 157, 69, 55, 24, 14, 6, 3, 1]
[9580, 6844, 4027, 1221, 867, 402, 187, 85, 45, 27, 7, 4, 2, 1]
[8307, 5664, 2729, 1920, 701, 266, 237, 92, 32, 29, 11, 3, 1, 0]
[8342, 5228, 2145, 1844, 520, 369, 155, 96, 42, 20, 10, 7, 2, 1]
[12511, 6564, 3962, 1119, 823, 410, 245, 114, 59, 16, 15, 3, 1, 0]
[15816, 6165, 3168, 1639, 883, 500, 143, 65, 53, 29, 12, 7, 1, 0]
[11733, 7411, 3716, 1560, 950, 373, 252, 113, 56, 19, 10, 5, 3, 1]
[9227, 4253, 2933, 1881, 899, 453, 254, 91, 55, 18, 13, 3, 1, 0]
[8735, 8048, 3502, 1740, 598, 442, 190, 115, 37, 16, 13, 6, 2, 0]
[9379, 7132, 2159, 1918, 813, 329, 226, 79, 35, 20, 7, 3, 2, 1]
[12449, 6595, 2636, 1929, 965, 403, 132, 78, 36, 15, 11, 6, 3, 1]
[9028, 6309, 3229, 1789, 926, 315, 188, 122, 42, 29, 14, 4, 2, 1]
[9060, 4590, 3500, 1300, 607, 332, 154, 89, 54, 18, 11, 7, 3, 0]
[11903, 7741, 2271, 1461, 957, 269, 231, 66, 42, 20, 15, 5, 2, 0]"""

instancesArr = instancesString.split('\n')

bb_res = []
greedy_res = []
kk_res = []
for i in instancesArr:
    bb_res.append(runBBWithSolutions(i)["val"])
    greedy_res.append(greedyPartition(i))
    kk_res.append(karmarkarKarp(i))

filename_raw = "datasheets/compare/figure5" + ".xlsx"
excelData = pd.DataFrame({"BB":bb_res, "GR": greedy_res, "KK": kk_res})
excelData.to_excel(filename_raw, sheet_name='data', index=False)
